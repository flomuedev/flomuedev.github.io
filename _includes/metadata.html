{% if site.enable_google_verification or site.enable_bing_verification %}
    <!-- Website verification -->
    {% if site.enable_google_verification -%}
    <meta name="google-site-verification" content="{{ site.google_site_verification }}" />
    {%- endif -%}
    {% if site.enable_bing_verification -%}
    <meta name="msvalidate.01" content="{{ site.bing_site_verification }}" />
    {%- endif -%}
    <!-- Avoid warning on Google Chrome
        Error with Permissions-Policy header: Origin trial controlled feature not enabled: 'interest-cohort'.
        see https://stackoverflow.com/a/75119417
    -->
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()" />
{%- endif %}

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
    {%- if site.title == "blank" -%}
        {%- capture title -%}{{ site.first_name }} {{ site.middle_name }} {{ site.last_name }}{%- endcapture -%}
    {%- else -%}
        {%- capture title -%}{{ site.title }}{%- endcapture -%}
    {%- endif -%}
    {% if page.url == '/blog/index.html' %}
        {{ site.blog_nav_title }} | {{ title }}
    {%- elsif page.title != "blank" and page.url != "/" -%}
        {%- if page.title == nil or page.title == "" -%}
            {{ page.date | date: "%Y" }} | {{ title }}
        {%- else -%}
            {{ page.title }} | {{ title }}
        {%- endif -%}
    {%- else -%}
        {{ title }}
    {%- endif -%}
    </title>
    <meta name="author" content="{{ site.first_name }} {{ site.middle_name }} {{ site.last_name }}" />
    <meta name="description" content="{%- if page.entry.abstract -%}{{ page.entry.abstract }}{%- elsif page.description -%}{{page.description}}{%- else -%}{{site.description}}{%- endif -%}" />

{%- if page.entry.keywords or page.keywords or site.keywords %}
    <meta name="keywords" content="{%- if page.entry.keywords -%}{{ page.entry.keywords }}{%- elsif page.keywords -%}{{ page.keywords }}{%- else -%}{{ site.keywords }}{%- endif -%}" />
{%- endif %}

{%- assign is_blog_post = false -%}
{%- if page.url != '/blog/index.html' and page.url contains '/blog/' -%}
    {%- unless page.url contains '/tag/' or page.url contains '/category/' -%}
        {%- assign is_blog_post = true -%}
    {%- endunless -%}
{%- endif -%}

{% assign base_preview_path = page.entry.key | prepend: '/assets/img/publication_preview/' | absolute_url  | append: '.jpg'%}
{% capture has_image %}{% file_exists {{page.entry.key | prepend: 'assets/img/publication_preview/' | append: '.jpg'}} %}{% endcapture %}


{%- if site.serve_og_meta %}
    <!-- OpenGraph -->
    <meta property="og:site_name" content="{{ title }}" />
    <meta property="og:type" content="{%- if page.reference -%}article{%- else -%}website{%- endif -%}" />
    <meta property="og:title" content="{%- if page.title -%}{{ title }} | {{ page.title }}{%- else -%}{{ title }}{%- endif -%}" />
    <meta property="og:url" content="{{ page.url | prepend: site.baseurl | prepend: site.url | remove_first: 'index.html' }}" />
    <meta property="og:description" content="{%- if page.entry.abstract -%}{{ page.entry.abstract }}{%- elsif page.description -%}{{ page.description }}{%- else -%}{{ site.description }}{%- endif -%}" />
    {% if has_image == "true" or page.og_image or site.og_image -%}
    <meta property="og:image" content="{%- if has_image == 'true'  -%}{{base_preview_path}}{%- elsif page.og_image -%}{{ page.og_image }}{%- else -%}{{ site.og_image }}{%- endif -%}" />
    {%- endif %}
    <meta property="og:locale" content="{{ site.lang }}" />

    <!-- Twitter card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="{%- if page.title -%}{{ page.title }}{%- else -%}{{ title }}{%- endif -%}" />
    <meta name="twitter:description" content="{%- if page.entry.abstract -%}{{ page.entry.abstract }}{%- elsif page.description -%}{{ page.description }}{%- else -%}{{ site.description }}{%- endif -%}" />
    {% if has_image == "true" or page.og_image or site.og_image -%}
    <meta name="twitter:image" content="{%- if has_image == 'true' -%}{{base_preview_path}}{%- elsif page.og_image -%}{{ page.og_image }}{%- else -%}{{ site.og_image }}{%- endif -%}" />
    {%- endif %}
    {% if site.x_username -%}
    <meta name="twitter:site" content="@{{ site.x_username }}" />
    <meta name="twitter:creator" content="@{{ site.x_username }}" />
    {%- endif %}
{%- endif %}

{%- if site.serve_schema_org %}

    <!-- Schema.org -->
    {%- assign person_id = "https://www.flomue.com/#person" -%}
    {%- assign website_id = "https://www.flomue.com/#website" -%}
    {%- assign homepage_url = "https://www.flomue.com/" -%}
    {%- assign page_url = page.url | replace: "index.html", "" | absolute_url -%}
    {%- assign page_name = page.title | default: site.title -%}
    {%- assign page_description = page.entry.abstract | default: page.description | default: site.description -%}
    {%- assign schema_site_name = site.title -%}
    {%- if schema_site_name == "blank" or schema_site_name == "" -%}
        {%- assign schema_site_name = site.first_name | append: " " | append: site.middle_name | append: " " | append: site.last_name | replace: "  ", " " | strip -%}
    {%- endif -%}
    {%- assign page_image = "" -%}
    {%- if has_image == "true" or page.og_image or site.og_image -%}
        {%- if has_image == "true" -%}
            {%- assign page_image = base_preview_path -%}
        {%- elsif page.og_image -%}
            {%- assign page_image = page.og_image -%}
        {%- else -%}
            {%- assign page_image = site.og_image -%}
        {%- endif -%}
    {%- endif -%}
    {%- assign is_homepage = false -%}
    {%- if page.url == "/" or page.url == "/index.html" -%}
        {%- assign is_homepage = true -%}
    {%- endif -%}
    {%- assign is_article = false -%}
    {%- if page.layout == "post" or is_blog_post or page.collection == "news" -%}
        {%- assign is_article = true -%}
    {%- endif -%}
    {%- assign same_as = "" | split: "," -%}
    {%- assign same_as = same_as | push: "https://www.informatik.tu-darmstadt.de/hci/hci_tuda/team_hci/details_152256.en.jsp" -%}
    {%- assign same_as = same_as | push: "https://www.informatik.tu-darmstadt.de/hci/hci_tuda/urbanpage.en.jsp" -%}
    {%- assign same_as = same_as | push: "https://orcid.org/0000-0002-9621-6214" -%}
    {%- assign same_as = same_as | push: "https://scholar.google.com/citations?user=slfzfQIAAAAJ" -%}
    {%- assign same_as = same_as | push: "https://dblp.org/pid/m/FlorianMueller-3.html" -%}
    {%- assign same_as = same_as | push: "https://dl.acm.org/profile/81464642529" -%}
    {%- assign same_as = same_as | push: "https://www.linkedin.com/in/florian-mueller-hci" -%}
    {%- assign same_as = same_as | push: "https://github.com/flomuedev" -%}
    {%- assign same_as = same_as | push: "https://www.wikidata.org/wiki/Q130893717" -%}

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@graph": [
            {
                "@type": "WebSite",
                "@id": "{{ website_id }}",
                "url": {{ homepage_url | jsonify }},
                "name": {{ schema_site_name | jsonify }},
                "publisher": {
                    "@id": "{{ person_id }}"
                }
            },
            {%- if is_homepage -%}
            {
                "@type": "Person",
                "@id": "{{ person_id }}",
                "name": {{ "Florian Müller" | jsonify }},
                "honorificPrefix": {{ "Prof. Dr." | jsonify }},
                "givenName": {{ "Florian" | jsonify }},
                "familyName": {{ "Müller" | jsonify }},
                "alternateName": [{{ "Florian Mueller" | jsonify }}],
                "url": {{ homepage_url | jsonify }},
                "image": {{ site.og_image | jsonify }},
                "jobTitle": {{ "Assistant Professor for Mobile Human-Computer Interaction" | jsonify }},
                "worksFor": {
                    "@type": "CollegeOrUniversity",
                    "name": {{ "TU Darmstadt" | jsonify }},
                    "url": {{ "https://www.tu-darmstadt.de/" | jsonify }}
                },
                "affiliation": {
                    "@type": "CollegeOrUniversity",
                    "name": {{ "TU Darmstadt" | jsonify }},
                    "url": {{ "https://www.tu-darmstadt.de/" | jsonify }}
                },
                "sameAs": {{ same_as | jsonify }}
            },
            {%- else -%}
            {
                "@type": "Person",
                "@id": "{{ person_id }}"
            },
            {%- endif -%}
            {
                "@type": {% if is_homepage %}["WebPage", "AboutPage"]{% else %}"WebPage"{% endif %},
                "@id": "{{ page_url }}#webpage",
                "url": {{ page_url | jsonify }},
                "name": {{ page_name | jsonify }},
                "description": {{ page_description | jsonify }},
                "isPartOf": {
                    "@id": "{{ website_id }}"
                },
                "about": {
                    "@id": "{{ person_id }}"
                }{% if is_homepage %},
                "mainEntity": {
                    "@id": "{{ person_id }}"
                }{% endif %}{% if page_image != "" %},
                "primaryImageOfPage": {
                    "@type": "ImageObject",
                    "@id": "{{ page_url }}#primaryimage",
                    "url": {{ page_image | jsonify }}
                }{% endif %}
            }{% if is_article %},
            {
                "@type": "BlogPosting",
                "@id": "{{ page_url }}#blogposting",
                "headline": {{ page_name | jsonify }},
                "datePublished": {{ page.date | date_to_xmlschema | jsonify }},
                "dateModified": {{ page.last_modified_at | default: page.date | date_to_xmlschema | jsonify }},
                "mainEntityOfPage": {
                    "@id": "{{ page_url }}#webpage"
                },
                "author": {
                    "@id": "{{ person_id }}"
                }{% if page_image != "" %},
                "image": {{ page_image | jsonify }}{% endif %}
            }{% endif %}
        ]
    }
    </script>

{%- endif %}
